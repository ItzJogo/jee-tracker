<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#0b0f14">
<title>JEE FOCUS TRACKER PRO â€” v9.0 (Modular)</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="/icons/icon-192.png">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Styles -->
<link rel="stylesheet" href="styles.css?v=9.2.0">
</head>
<body>

<!-- Accessibility Live Region -->
<div aria-live="polite" id="liveRegion"></div>

<!-- Main App Container -->
<div class="app">
  
  <!-- Header / Top Bar -->
  <header class="header">
    <div class="header-brand">
      <div class="avatar" id="avatar">YR</div>
      <div class="header-text">
        <h1 class="header-title">JEE FOCUS TRACKER</h1>
        <p class="header-subtitle">v9.0 PRO â€” Production Architecture</p>
      </div>
    </div>
    
    <nav class="header-actions">
      <button class="btn btn-icon" id="exportBtn" aria-label="Export all data" title="Export Data">
        <span>ğŸ’¾</span>
      </button>
      <button class="btn btn-icon" id="importBtn" aria-label="Import data from file" title="Import Data">
        <span>ğŸ“¥</span>
      </button>
      <button class="btn btn-icon" id="themeToggle" aria-label="Toggle light/dark theme" title="Toggle Theme">
        <span>â˜€ï¸</span>
      </button>
    </nav>
  </header>

  <!-- Main Content Area -->
  <main class="container">
    
    <!-- Form Column (Left on Desktop) -->
    <section id="form-column">
      
      <!-- Task Form Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Add New Task</h2>
          <div id="todayDate" class="card-subtitle"></div>
        </header>
        
        <form class="task-form" id="taskForm">
          <!-- Task Title -->
          <div class="form-group">
            <input 
              type="text" 
              id="title" 
              class="input input-full" 
              placeholder="Study task (e.g., GOC + 20Q)"
              aria-label="Task title"
            />
          </div>
          
          <!-- Form Grid: Subject, Chapter, Priority -->
          <div class="form-grid">
            <div class="form-group">
              <select id="subject" class="input" aria-label="Subject">
                <option value="Chemistry">âš—ï¸ Chemistry</option>
                <option value="Physics">âš¡ Physics</option>
                <option value="Math">âˆ Math</option>
                <option value="Biology">ğŸ§¬ Biology</option>
              </select>
            </div>
            
            <div class="form-group">
              <select id="chapter" class="input" aria-label="Chapter">
                <option value="">Select Chapter</option>
              </select>
            </div>
            
            <div class="form-group">
              <select id="priority" class="input" aria-label="Priority">
                <option value="High">ğŸ”´ High</option>
                <option value="Medium" selected>ğŸŸ¡ Medium</option>
                <option value="Low">ğŸŸ¢ Low</option>
              </select>
            </div>
            
            <div class="form-group">
              <input 
                type="number" 
                id="minutes" 
                class="input" 
                placeholder="Minutes"
                aria-label="Expected minutes"
              />
            </div>
            
            <div class="form-group">
              <select id="blockSel" class="input" aria-label="Time block">
                <option value="Block A">ğŸŒ… Block A (Morning)</option>
                <option value="Block B">â˜€ï¸ Block B (Late Morning)</option>
                <option value="Block C">ğŸŒ¤ï¸ Block C (Afternoon)</option>
                <option value="Block D">ğŸŒ™ Block D (Night)</option>
              </select>
            </div>
            
            <div class="form-group">
              <input 
                type="text" 
                id="backlogTag" 
                class="input" 
                placeholder="Tag (Optional)"
                aria-label="Task tag"
              />
            </div>
          </div>
          
          <!-- Search Input -->
          <div class="form-group">
            <input 
              type="text" 
              id="searchInput" 
              class="input input-search" 
              placeholder="ğŸ” Search tasks..."
              aria-label="Search tasks"
            />
          </div>
          
          <!-- Action Buttons -->
          <div class="btn-group">
            <button type="button" class="btn btn-primary" id="addBtn">
              <span>â•</span> Add Task
            </button>
            <button type="button" class="btn btn-secondary" id="cancelEditBtn" style="display:none;">
              Cancel Edit
            </button>
            <button type="button" class="btn btn-icon" id="voiceBtn" title="Add task via voice" aria-label="Voice input">
              <span>ğŸ¤</span>
            </button>
            <button type="button" class="btn btn-icon" id="templateBtn" title="Quick templates" aria-label="Open templates">
              <span>ğŸ“„</span>
            </button>
          </div>
        </form>
      </article>
      
      <!-- Task List Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Your Tasks</h2>
          <div id="dateSmall" class="card-subtitle"></div>
        </header>
        
        <!-- Filters -->
        <div class="filter-group">
          <select id="filterSubject" class="input input-small" aria-label="Filter by subject">
            <option value="">All Subjects</option>
          </select>
          <select id="filterPriority" class="input input-small" aria-label="Filter by priority">
            <option value="">All Priorities</option>
          </select>
          <button type="button" class="btn btn-small" id="clearFiltersBtn">Clear</button>
        </div>
        
        <!-- Task List Container -->
        <div id="taskList" class="task-list" role="list"></div>
        
        <!-- Eva Alert -->
        <div id="evaAlert" class="eva-alert"></div>
      </article>
      
      <!-- Reflection Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Daily Reflection</h2>
          <div class="card-subtitle">Auto-saves as you type</div>
        </header>
        
        <div class="form-group">
          <textarea 
            id="reflection" 
            class="input textarea" 
            placeholder="How was your study session today? What did you learn?"
            rows="4"
            aria-label="Daily reflection"
          ></textarea>
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-primary" id="saveRef">ğŸ’¾ Save</button>
          <button type="button" class="btn btn-secondary" id="clearRef">Clear</button>
          <div id="autoSaveStatus" class="auto-save-status">Last saved: â€”</div>
        </div>
      </article>
      
      <!-- Daily Goal Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Daily Goal</h2>
          <div class="form-group-inline">
            <input 
              type="number" 
              id="dailyGoalInput" 
              class="input input-tiny" 
              value="240"
              aria-label="Daily goal in minutes"
            />
            <span class="card-subtitle">minutes</span>
          </div>
        </header>
        
        <div class="progress-container">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>
          </div>
          <div id="progressText" class="progress-text">0 / 240 mins (0%)</div>
        </div>
        
        <div class="streak-container">
          <div class="streak-info">
            <div class="streak-label">Current Streak</div>
            <div id="streak" class="streak-value">0 days ğŸ”¥</div>
          </div>
          <button type="button" class="btn btn-secondary btn-small" id="resetStreak">Reset</button>
        </div>
      </article>
      
      <!-- Syllabus Progress Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Syllabus Progress</h2>
          <select id="syllabusSubject" class="input input-small" aria-label="Select subject for syllabus">
            <option value="Physics">âš¡ Physics</option>
            <option value="Chemistry">âš—ï¸ Chemistry</option>
            <option value="Math">âˆ Math</option>
            <option value="Biology">ğŸ§¬ Biology</option>
          </select>
        </header>
        
        <div id="syllabusChapters" class="syllabus-chapters">
          <div class="empty-message">No progress yet â€” add tasks with chapters!</div>
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-primary" id="updateSyllabusBtn">Update Progress</button>
          <button type="button" class="btn btn-secondary" id="exportSyllabusBtn">Export</button>
        </div>
      </article>
      
      <!-- Pomodoro Setup Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">â±ï¸ Pomodoro Timer</h2>
          <div class="card-subtitle">Focus sessions</div>
        </header>
        
        <div class="form-grid-small">
          <input 
            type="number" 
            id="pomoWorkInput" 
            class="input" 
            value="25" 
            placeholder="Work mins"
            aria-label="Work minutes"
          />
          <input 
            type="number" 
            id="pomoBreakInput" 
            class="input" 
            value="5" 
            placeholder="Break mins"
            aria-label="Break minutes"
          />
          <button type="button" class="btn btn-secondary" id="setTimesBtn">Set</button>
        </div>
        
        <div class="pomo-display">
          <div id="pomoTimer" class="pomo-timer" aria-live="polite">25:00</div>
          <div class="btn-group">
            <button type="button" class="btn btn-primary" id="pStart" aria-label="Start timer">â–¶ï¸ Start</button>
            <button type="button" class="btn btn-secondary" id="pPause" aria-label="Pause timer">â¸ï¸ Pause</button>
            <button type="button" class="btn btn-secondary" id="pReset" aria-label="Reset timer">ğŸ”„ Reset</button>
          </div>
        </div>
        
        <div class="checkbox-group">
          <input type="checkbox" id="autoStartPomo" />
          <label for="autoStartPomo">Auto-start next session</label>
        </div>
      </article>
      
    </section>
    
    <!-- Tasks Column (Right on Desktop) -->
    <section id="tasks-column">
      
      <!-- Dashboard Stats Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">ğŸ“Š Dashboard</h2>
        </header>
        
        <div class="stats-grid">
          <div class="stat-card stat-total">
            <div class="stat-label">Total</div>
            <div id="total" class="stat-value">0</div>
          </div>
          <div class="stat-card stat-done">
            <div class="stat-label">Done</div>
            <div id="done" class="stat-value">0</div>
          </div>
          <div class="stat-card stat-missed">
            <div class="stat-label">Missed</div>
            <div id="missed" class="stat-value">0</div>
          </div>
        </div>
      </article>
      
      <!-- Subject Progress Chart Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Subject Progress (Today)</h2>
        </header>
        <div class="chart-container">
          <canvas id="progressChart"></canvas>
        </div>
      </article>
      
      <!-- Syllabus Overall Chart Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">Overall Syllabus</h2>
        </header>
        <div class="chart-container">
          <canvas id="syllabusChart"></canvas>
        </div>
      </article>
      
      <!-- Calendar Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">ğŸ“… Last 7 Days</h2>
        </header>
        <div id="calendar" class="calendar-grid"></div>
      </article>
      
      <!-- Media Log Card -->
      <article class="card">
        <header class="card-header">
          <h2 class="card-title">ğŸ¬ Anime / Manga Log</h2>
        </header>
        
        <div class="form-group">
          <input 
            type="text" 
            id="mediaTitleInput" 
            class="input" 
            placeholder="Add title"
            aria-label="Media title"
          />
        </div>
        
        <div class="btn-group">
          <button type="button" class="btn btn-primary" id="addAnimeBtn">ğŸ“º Anime</button>
          <button type="button" class="btn btn-primary" id="addMangaBtn">ğŸ“– Manga</button>
        </div>
        
        <div class="media-lists">
          <div class="media-section">
            <div class="media-label">ğŸ“º Anime</div>
            <div id="animeListContainer" class="media-list"></div>
          </div>
          
          <div class="media-section">
            <div class="media-label">ğŸ“– Manga</div>
            <div id="mangaListContainer" class="media-list"></div>
          </div>
        </div>
      </article>
      
    </section>
    
  </main>
  
</div>

<!-- Edit Modal -->
<div id="editModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="edit-modal-title">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <header class="modal-header">
      <h3 id="edit-modal-title" class="modal-title">Edit Task</h3>
      <button class="modal-close" id="editClose" aria-label="Close modal">&times;</button>
    </header>
    
    <form class="modal-body">
      <div class="form-group">
        <input 
          type="text" 
          id="editTitle" 
          class="input input-full" 
          placeholder="Task Title"
          aria-label="Edit task title"
        />
      </div>
      
      <div class="form-grid">
        <div class="form-group">
          <select id="editSubject" class="input" aria-label="Edit subject">
            <option value="Chemistry">âš—ï¸ Chemistry</option>
            <option value="Physics">âš¡ Physics</option>
            <option value="Math">âˆ Math</option>
            <option value="Biology">ğŸ§¬ Biology</option>
          </select>
        </div>
        
        <div class="form-group">
          <select id="editChapter" class="input" aria-label="Edit chapter">
            <option value="">Select Chapter</option>
          </select>
        </div>
        
        <div class="form-group">
          <select id="editPriority" class="input" aria-label="Edit priority">
            <option value="High">ğŸ”´ High</option>
            <option value="Medium">ğŸŸ¡ Medium</option>
            <option value="Low">ğŸŸ¢ Low</option>
          </select>
        </div>
        
        <div class="form-group">
          <input 
            type="number" 
            id="editMinutes" 
            class="input" 
            placeholder="Minutes"
            aria-label="Edit minutes"
          />
        </div>
        
        <div class="form-group">
          <select id="editBlock" class="input" aria-label="Edit time block">
            <option value="Block A">ğŸŒ… Block A (Morning)</option>
            <option value="Block B">â˜€ï¸ Block B (Late Morning)</option>
            <option value="Block C">ğŸŒ¤ï¸ Block C (Afternoon)</option>
            <option value="Block D">ğŸŒ™ Block D (Night)</option>
          </select>
        </div>
        
        <div class="form-group">
          <input 
            type="text" 
            id="editBacklog" 
            class="input" 
            placeholder="Tag"
            aria-label="Edit tag"
          />
        </div>
      </div>
    </form>
    
    <footer class="modal-footer">
      <button type="button" class="btn btn-primary" id="saveEditBtn">ğŸ’¾ Save Changes</button>
      <button type="button" class="btn btn-danger" id="deleteEditBtn">ğŸ—‘ï¸ Delete Task</button>
    </footer>
  </div>
</div>

<!-- Template Modal -->
<div id="templateModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="template-modal-title">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <header class="modal-header">
      <h3 id="template-modal-title" class="modal-title">Quick Templates</h3>
      <button class="modal-close" id="tempClose" aria-label="Close modal">&times;</button>
    </header>
    
    <div class="modal-body">
      <div class="template-grid">
        <button type="button" class="btn btn-template" onclick="applyTemplate('Chemistry','GOC Revision','GOC',30,'High')">
          âš—ï¸ GOC â€“ 30 min
        </button>
        <button type="button" class="btn btn-template" onclick="applyTemplate('Physics','Kinematics PYQs','Kinematics',45,'High')">
          âš¡ Kinematics PYQ â€“ 45 min
        </button>
        <button type="button" class="btn btn-template" onclick="applyTemplate('Math','Trigonometry Crash','Trigonometry',40,'Medium')">
          âˆ Trigonometry â€“ 40 min
        </button>
        <button type="button" class="btn btn-template" onclick="applyTemplate('Chemistry','Nomenclature','Basic Organic',20,'Low')">
          âš—ï¸ OC Nomenclature â€“ 20 min
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Floating Pomodoro Widget -->
<aside class="pomo-fab" id="miniPomo">
  <div class="pomo-fab-label">â±ï¸ Pomodoro</div>
  <div id="miniTimer" class="pomo-fab-timer">25:00</div>
  <div class="pomo-fab-controls">
    <button class="btn-fab" id="miniStart" aria-label="Start timer">â–¶ï¸</button>
    <button class="btn-fab" id="miniPause" aria-label="Pause timer">â¸ï¸</button>
  </div>
</aside>

<!-- Modular JavaScript -->
<script type="module" src="main.js?v=9.1.0"></script>

<!-- Service Worker Registration -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js')
        .then(reg => console.log('Service Worker registered.', reg))
        .catch(err => console.error('Service Worker registration failed:', err));
    });
  }
</script>

</body>
</html>
